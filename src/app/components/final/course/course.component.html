<div class="outer">
  <div class="courseBody">
    <div>
      <p>Kurstitel:</p>
      <p *ngIf="!isEdit; else editTitle">
        {{ courseDetails.courseTitle }}
      </p>
      <ng-template #editTitle>
        <input type="text" [(ngModel)]="courseEditData.courseTitle" />
      </ng-template>
    </div>
    <div>
      <p>Kursnummer:</p>
      <p>
        {{ courseDetails.courseNumber }}
      </p>
    </div>
    <div>
      <p>Beschreibung:</p>
      <p *ngIf="!isEdit; else editDescription">
        {{ courseDetails.description }}
      </p>
      <ng-template #editDescription>
        <input type="text" [(ngModel)]="courseEditData.description" />
      </ng-template>
    </div>
    <div class="listWrapper">
      <table>
        <thead>
          <tr>
            <th>Datum</th>
            <th>Start Zeit</th>
            <th>End Zeit</th>
          </tr>
        </thead>
        <tbody>
          <ng-container *ngFor="let cd of courseDetails.dates; let i = index">
            <tr>
              <td>{{ dateConverterService.getDate(cd) }}</td>
              <td>{{ dateConverterService.getStartTime(cd) }}</td>
              <td>
                {{
                  dateConverterService.getEndTime(cd, courseDetails.duration)
                }}
              </td>
              <td *ngIf="isEdit">
                <button (click)="deleteDate(i)">-</button>
              </td>
            </tr>
          </ng-container>
        </tbody>
      </table>
      <button *ngIf="isEdit" (click)="addDate()">Termin hinzufügen</button>
    </div>

    <div>
      <p>Maximale Teilnehmeanzahl:</p>
      <p *ngIf="!isEdit; else editParticipantsCount">
        {{ courseDetails.maxParticipants }}
      </p>
      <ng-template #editParticipantsCount>
        <input type="number" [(ngModel)]="courseEditData.maxParticipants" />
      </ng-template>
    </div>
    <div class="listWrapper">
      <table>
        <thead>
          <tr>
            <th>Vorname</th>
            <th>Kurs Teilnehmer Nachname</th>
            <th>Status</th>
            <th>Email</th>
            <th>Telefonnummer</th>
          </tr>
        </thead>
        <tbody>
          <ng-container *ngIf="!isEdit; else editParticipants">
            <ng-container
              *ngFor="
                let p of fullParticipantsList(
                  courseDetails.participants,
                  courseDetails.maxParticipants
                );
                let i = index
              "
            >
              <tr>
                <td>
                  {{ p.firstname != "" ? p.firstname : "leer" }}
                </td>
                <td>
                  {{ p.lastname != "" ? p.lastname : "leer" }}
                </td>
                <td>
                  {{ p.status != "" ? p.status : "leer" }}
                </td>
                <td>
                  {{ p.eMail != "" ? p.eMail : "leer" }}
                </td>
                <td>
                  {{ p.phonenumber != "" ? p.phonenumber : "leer" }}
                </td>
              </tr>
            </ng-container>
          </ng-container>
          <ng-template #editParticipants>
            <ng-container
              *ngFor="
                let p of fullParticipantsList(
                  courseEditData.participants,
                  courseEditData.maxParticipants
                );
                let i = index
              "
            >
              <tr>
                <td>
                  <input
                    type="text"
                    [(ngModel)]="p.firstname"
                    [placeholder]="p.firstname ? p.firstname : 'leer'"
                  />
                </td>
                <td>
                  <input
                    type="text"
                    [(ngModel)]="p.lastname"
                    [placeholder]="p.lastname ? p.lastname : 'leer'"
                  />
                </td>
                <td>
                  <input
                    type="text"
                    [(ngModel)]="p.status"
                    [placeholder]="p.status ? p.status : 'leer'"
                  />
                </td>
                <td>
                  <input
                    type="text"
                    [(ngModel)]="p.eMail"
                    [placeholder]="p.eMail ? p.eMail : 'leer'"
                  />
                </td>
                <td>
                  <input
                    type="text"
                    [(ngModel)]="p.phonenumber"
                    [placeholder]="p.phonenumber ? p.phonenumber : 'leer'"
                  />
                </td>
                <td *ngIf="isEdit">
                  <button (click)="deleteParticipant(i)">-</button>
                </td>
              </tr>
            </ng-container>
          </ng-template>
        </tbody>
      </table>
      <button *ngIf="isEdit" (click)="addParticipant()">
        Teilnehmer hinzufügen
      </button>
    </div>
    <div>
      <p>Wartelistenlänge:</p>
      <p>
        {{ courseDetails.waitList.length }}
      </p>
    </div>
    <div>
      <div>
        <p>Preise:</p>
      </div>
      <div class="priceWrapper">
        <ng-container *ngFor="let price of courseDetails.priceList">
          <div class="price">
            <p>{{ price.priceName }}:</p>
            <p>{{ price.priceValue }}</p>
          </div>
        </ng-container>
        <button *ngIf="isEdit" (click)="addPrice()">Preis hinzufügen</button>
      </div>
    </div>
    <div>
      <p>Ort:</p>
      <p *ngIf="!isEdit; else editPlace">
        {{ courseDetails.place }}
      </p>
      <ng-template #editPlace>
        <input type="text" [(ngModel)]="courseEditData.place" />
      </ng-template>
    </div>
    <div>
      <p>Trainer Qualifikation:</p>
      <ng-container *ngFor="let q of courseDetails.trainerQualifications">
        <li>{{ q.skill }}</li>
      </ng-container>
    </div>
    <div>
      <p>Trainer:</p>
      <ng-container *ngFor="let t of courseDetails.trainers">
        <li>{{ t.trainerName }}</li>
      </ng-container>
    </div>
    <div>
      <p>Notizen:</p>
      <p *ngIf="!isEdit; else editNotes">
        {{ courseDetails.notes }}
      </p>
      <ng-template #editNotes>
        <input type="text" [(ngModel)]="courseEditData.notes" />
      </ng-template>
    </div>
  </div>
  <div class="button-div">
    <button mat-raised-button color="primary" (click)="save()" *ngIf="isEdit">
      Speichern
    </button>
    <button (click)="deleteCourse()" *ngIf="isDelete">Löschen</button>
    <button mat-raised-button (click)="cancel()">
      {{ isEdit || isDelete ? "Abbrechen" : "schließen" }}
    </button>
  </div>
</div>
